{% extends "base.html" %}
{% block content %}
  <h2>Dashboard</h2>
  <div id="chart-wrap">
    <canvas id="moodChart" width="600" height="300"></canvas>
  </div>
  <p><i>Below is a simple visualization of your mood logs (Negative = -1, Neutral = 0, Positive = 1).</i></p>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const moodData = (mood_data|safe)  ;
    const labels = moodData.map(d => d.date);
    const values = moodData.map(d => d.value);
    const colors = moodData.map(d => d.value === 1 ? 'green' : (d.value === -1 ? 'red' : 'gray'));

    const ctx = document.getElementById('moodChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [{
          label: 'Mood over time',
          data: values,
          backgroundColor: 'rgba(0, 123, 255, 0.2)',
          borderColor: 'rgba(0, 123, 255, 0.8)',
          fill: true,
          tension: 0.3
        }]
      },
      options: {
        scales: {
          y: { min: -1.5, max: 1.5, ticks: { stepSize: 1 } }
        }
      }
    });
  </script>
{% endblock %}
